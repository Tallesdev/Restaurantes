<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Lista de Produtos</title>
  <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>

<div class="container">
  <div th:replace="fragments/navbar :: main-navbar"></div>
  <h1>Produtos Cadastrados</h1>

  <div class="filter-box">
    <h2>Filtro de Produtos</h2>
    <form th:action="@{/produtos/listar}" method="get" class="filter-row">

      <div class="form-group">
        <label for="nomeBusca">Nome:</label>
        <input type="text"
               id="nomeBusca"
               name="nomeBusca"
               th:value="${nomeBuscaAtual}"
               placeholder="Buscar por nome...">
      </div>

      <div class="form-group">
        <label for="precoMin">Preço Mínimo:</label>
        <input type="number"
               id="precoMin"
               name="precoMin"
               step="0.01"
               th:value="${precoMinAtual}"
               placeholder="R$ 0.00">
      </div>

      <button type="submit" class="btn btn-primary">
        Filtrar
      </button>

      <a th:href="@{/produtos/listar}" class="btn btn-secondary">Limpar</a>
    </form>
  </div>

  <div th:if="${mensagem}" class="mensagem-sucesso" th:text="${mensagem}">Mensagem de Sucesso!</div>
  <div th:if="${erro}" class="mensagem-erro" th:text="${erro}">Mensagem de Erro!</div>

  <a th:href="@{/produtos/novo}" class="btn btn-primary">Novo Produto</a>

  <table class="data-table">
    <thead>
    <tr>
      <th>ID</th>
      <th>Nome</th>
      <th>Preço</th>
      <th>Categoria</th>
      <th>Descrição</th>
      <th>Ações</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="produto : ${produtos}">
      <td th:text="${produto.id}">1</td>
      <td th:text="${produto.nome}">Hamburguer</td>
      <td th:text="${#numbers.formatCurrency(produto.preco)}">R$ 25,00</td>
      <td th:text="${produto.categoria}">Prato Principal</td>
      <td th:text="${produto.descricao}">Carne, queijo e salada.</td>
      <td>
        <a th:href="@{/produtos/editar/{id}(id=${produto.id})}" class="btn btn-primary btn-sm">Editar</a>
        <a th:href="@{/produtos/excluir/{id}(id=${produto.id})}"
           onclick="return confirm('Tem certeza que deseja excluir este produto?')"
           class="btn btn-danger btn-sm">Excluir</a>
      </td>
    </tr>
    <tr th:if="${#lists.isEmpty(produtos)}">
      <td colspan="6">Nenhum produto cadastrado.</td>
    </tr>
    </tbody>
  </table>

</div>
</body>
</html>